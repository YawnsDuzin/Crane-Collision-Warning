"""
크레인 충돌 예측 시스템 - 전체 설정값
=============================================

이 파일은 시스템의 모든 설정값을 한 곳에서 관리합니다.
현장 상황에 맞게 이 값들을 수정하면 됩니다.

[설정값 변경 가이드]
- 안전 거리를 늘리고 싶다면: ALERT_THRESHOLDS의 거리 값을 수정
- 크레인을 추가하고 싶다면: DEFAULT_CRANES 리스트에 추가
- 데이터 수집 주기를 바꾸고 싶다면: SIMULATION_INTERVAL_MS 수정
"""


# ============================================================
# 1. 서버 설정
# ============================================================
# FastAPI 웹 서버가 실행될 주소와 포트
SERVER_HOST = "0.0.0.0"   # 모든 네트워크에서 접속 허용
SERVER_PORT = 8000         # 웹 브라우저에서 http://localhost:8000 으로 접속

# ============================================================
# 2. 시뮬레이션 설정
# ============================================================
# 시뮬레이션에서 데이터를 갱신하는 주기 (밀리초)
# 100ms = 0.1초마다 크레인 위치를 새로 계산
SIMULATION_INTERVAL_MS = 100

# WebSocket으로 브라우저에 데이터를 보내는 주기 (밀리초)
# 200ms = 0.2초마다 화면을 갱신
WEBSOCKET_BROADCAST_INTERVAL_MS = 200

# ============================================================
# 3. 경고 기준값 (Alert Thresholds)
# ============================================================
# 크레인 간 거리에 따른 위험 등급을 정의합니다.
#
# 예시: 두 크레인이 7m 떨어져 있다면?
#   → DANGER(3m) 이상, WARNING(5m) 이상, CAUTION(10m) 이하
#   → "주의(CAUTION)" 등급
#
ALERT_THRESHOLDS = {
    # 등급명: (거리 기준(m), 예상 충돌 시간 기준(초))
    "DANGER":  {"distance": 3.0,  "time_to_collision": 5.0},   # 위험: 즉시 정지
    "WARNING": {"distance": 5.0,  "time_to_collision": 10.0},  # 경고: 속도 제한
    "CAUTION": {"distance": 10.0, "time_to_collision": 30.0},  # 주의: 운전자 알림
    "NORMAL":  {"distance": 999.0, "time_to_collision": 999.0}, # 정상: 정상 운행
}

# 경고 등급별 색상 (웹 화면 표시용)
ALERT_COLORS = {
    "DANGER":  "#FF0000",  # 빨강
    "WARNING": "#FF8C00",  # 주황
    "CAUTION": "#FFD700",  # 노랑
    "NORMAL":  "#00CC00",  # 초록
}

# ============================================================
# 4. 충돌 예측 설정
# ============================================================
# 미래 위치 예측 시 몇 초 앞까지 계산할지
PREDICTION_TIME_SECONDS = 30.0

# 예측 시 시간 간격 (초)
# 0.5초 간격으로 30초까지 = 60개 미래 시점을 계산
PREDICTION_STEP_SECONDS = 0.5

# 안전 여유 거리 (m)
# 이 거리 안에 들어오면 "충돌 가능성 있음"으로 판단
SAFETY_MARGIN_METERS = 2.0

# ============================================================
# 5. 기본 크레인 설정 (시뮬레이션용)
# ============================================================
# 시뮬레이터에서 사용할 기본 크레인 구성
# 실제 현장에서는 이 값을 현장 크레인에 맞게 수정합니다.
#
# 각 항목 설명:
#   id: 크레인 고유 번호 (예: "TC-1")
#   name: 표시 이름
#   base_x, base_y: 크레인 기초 위치 (미터, 현장 좌표계)
#   mast_height: 마스트(기둥) 높이 (미터)
#   boom_length: 붐대(팔) 길이 (미터)
#   initial_slew_angle: 초기 선회각 (도, 0=북쪽, 시계방향)
#   initial_luffing_angle: 초기 기복각 (도, 0=수평)
#   slew_speed: 선회 속도 (도/초) - 보통 0.5~1.0도/초
#
DEFAULT_CRANES = [
    {
        "id": "TC-1",
        "name": "1호기",
        "base_x": 0.0,
        "base_y": 0.0,
        "mast_height": 40.0,
        "boom_length": 60.0,
        "initial_slew_angle": 45.0,
        "initial_luffing_angle": 15.0,
        "slew_speed": 0.0,
    },
    {
        "id": "TC-2",
        "name": "2호기",
        "base_x": 80.0,
        "base_y": 0.0,
        "mast_height": 45.0,
        "boom_length": 55.0,
        "initial_slew_angle": 200.0,
        "initial_luffing_angle": 10.0,
        "slew_speed": 0.0,
    },
    {
        "id": "TC-3",
        "name": "3호기",
        "base_x": 40.0,
        "base_y": 70.0,
        "mast_height": 42.0,
        "boom_length": 50.0,
        "initial_slew_angle": 270.0,
        "initial_luffing_angle": 12.0,
        "slew_speed": 0.0,
    },
]

# ============================================================
# 6. 단위 변환 상수
# ============================================================
import math

# 각도를 라디안으로 변환하는 상수
# 컴퓨터는 삼각함수 계산 시 라디안 단위를 사용합니다.
# 예: 90도 × DEG_TO_RAD = 약 1.5708 라디안
DEG_TO_RAD = math.pi / 180.0

# 라디안을 각도로 변환하는 상수
RAD_TO_DEG = 180.0 / math.pi
