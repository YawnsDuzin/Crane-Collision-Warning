# 수학 기초 - 삼각함수 (sin, cos)

> **수학을 못해도 괜찮습니다!** 이 문서는 중학교 수학부터 차근차근 설명합니다.
> 크레인 시스템에서 "왜 sin, cos를 쓰는지"를 이해하는 것이 목표입니다.

---

## 왜 삼각함수가 필요한가?

크레인의 붐대는 **비스듬하게** 놓여 있습니다.

```
             ● 붐대 끝점
            ╱
           ╱  60m (붐대 길이)
          ╱
         ╱ 30도 (기복각)
        ╱
       ●────────────────── ? m (수평 거리)
```

**문제**: 붐대 길이가 60m이고 기복각이 30도일 때, 수평 거리(가로)와 높이(세로)는 각각 얼마인가?

이 질문에 답하려면 **삼각함수**가 필요합니다.

---

## 직각삼각형 복습

삼각함수를 이해하려면, 먼저 **직각삼각형**을 알아야 합니다.

```
          ╱│
    빗변 ╱  │ 높이
  (가장 ╱   │ (세로)
   긴 변)   │
      ╱ θ   │
     ●──────┘
      밑변 (가로)
```

- **빗변**: 가장 긴 변 (비스듬한 변)
- **밑변**: 가로 (수평) 길이
- **높이**: 세로 (수직) 길이
- **θ (세타)**: 각도

크레인에 대입하면:
- **빗변** = 붐대 길이
- **밑변** = 수평 도달 거리
- **높이** = 붐대가 올라간 높이
- **θ** = 기복각

---

## cos (코사인) - "가로 비율"

**cos(각도)** = 밑변 / 빗변

쉽게 말하면: **"전체 길이 중에서 가로 방향이 차지하는 비율"**

```
cos(각도) = 가로 ÷ 빗변

가로 = 빗변 × cos(각도)
```

### cos 값 표 (외울 필요 없습니다!)

| 각도 | cos 값 | 의미 |
|------|--------|------|
| 0도 | **1.000** | 완전히 가로 → 가로 = 빗변 전체 |
| 15도 | 0.966 | 거의 가로 → 빗변의 97% |
| 30도 | **0.866** | 약간 기울어짐 → 빗변의 87% |
| 45도 | 0.707 | 대각선 → 빗변의 71% |
| 60도 | **0.500** | 많이 기울어짐 → 빗변의 50% |
| 90도 | **0.000** | 완전히 세로 → 가로 = 0 |

### 실제 크레인 예시

붐대 길이 60m, 기복각 30도일 때 **수평 도달 거리**:

```
수평 거리 = 60m × cos(30도)
         = 60m × 0.866
         = 51.96m ≈ 약 52m
```

```
                         ● 붐대 끝점
                        ╱│
                       ╱ │
             60m      ╱  │ 30m (높이)
                     ╱   │
                    ╱ 30°│
   마스트 꼭대기 ●────────┘
                 ←─ 52m ─→
                (수평 거리)
```

**코드에서 사용되는 곳** (`core/geometry.py:103`):
```python
horizontal_reach = boom_length * math.cos(luff_rad)
# 수평 도달 거리 = 붐대 길이 × cos(기복각)
```

---

## sin (사인) - "세로 비율"

**sin(각도)** = 높이 / 빗변

쉽게 말하면: **"전체 길이 중에서 세로 방향이 차지하는 비율"**

```
sin(각도) = 세로 ÷ 빗변

세로 = 빗변 × sin(각도)
```

### sin 값 표

| 각도 | sin 값 | 의미 |
|------|--------|------|
| 0도 | **0.000** | 완전히 가로 → 세로 = 0 |
| 15도 | 0.259 | 거의 가로 → 빗변의 26% |
| 30도 | **0.500** | 약간 기울어짐 → 빗변의 50% |
| 45도 | 0.707 | 대각선 → 빗변의 71% |
| 60도 | **0.866** | 많이 기울어짐 → 빗변의 87% |
| 90도 | **1.000** | 완전히 세로 → 세로 = 빗변 전체 |

> **관찰**: sin과 cos의 값이 서로 뒤집어져 있습니다!
> cos(30도) = 0.866, sin(60도) = 0.866
> 이건 우연이 아닙니다. sin과 cos는 "같은 삼각형의 다른 면"을 보기 때문입니다.

### 실제 크레인 예시

붐대 길이 60m, 기복각 30도일 때 **붐대가 올라간 높이**:

```
높이 증가 = 60m × sin(30도)
         = 60m × 0.500
         = 30.0m
```

마스트 높이가 40m이라면:
```
붐대 끝점 높이 = 마스트 높이 + 높이 증가
              = 40m + 30m
              = 70m
```

**코드에서 사용되는 곳** (`core/geometry.py:111`):
```python
tip_z = mast_height + boom_length * math.sin(luff_rad)
# 끝점 높이 = 마스트 높이 + 붐대 길이 × sin(기복각)
```

---

## sin과 cos의 핵심 규칙

```
┌─────────────────────────────────────────────┐
│                                             │
│   빗변(전체) 을 알 때:                       │
│                                             │
│   가로 = 빗변 × cos(각도)                   │
│   세로 = 빗변 × sin(각도)                   │
│                                             │
│   이것만 기억하면 됩니다!                    │
│                                             │
└─────────────────────────────────────────────┘
```

검증: 기복각이 0도(완전 수평)일 때
```
가로 = 60m × cos(0도) = 60m × 1.0 = 60m  ← 붐대 전체가 가로
세로 = 60m × sin(0도) = 60m × 0.0 = 0m   ← 높이 변화 없음 ✓
```

검증: 기복각이 90도(완전 수직)일 때
```
가로 = 60m × cos(90도) = 60m × 0.0 = 0m   ← 수평 거리 없음 ✓
세로 = 60m × sin(90도) = 60m × 1.0 = 60m  ← 붐대 전체가 세로
```

---

## 방향 결정 - 선회각에서 sin, cos 사용

지금까지는 **한쪽 방향**에서만 봤습니다 (옆에서 본 모습).
이제 **위에서 내려다본 방향**을 정해야 합니다.

```
위에서 내려다본 모습:

        Y (북쪽)
        │
        │   ● 붐대 끝점
        │  ╱
        │╱ θ  ← 선회각
   ─────●──────── X (동쪽)
       기초
```

선회각(θ)이 주어졌을 때, 수평 거리를 X방향과 Y방향으로 **나누어야** 합니다.

```
X 방향 (동쪽) = 수평거리 × sin(선회각)
Y 방향 (북쪽) = 수평거리 × cos(선회각)
```

### 왜 X에 sin이고 Y에 cos인가?

우리 시스템에서 **0도 = 북쪽(Y축 방향)**이기 때문입니다.

| 선회각 | sin(선회각) | cos(선회각) | X(동쪽) | Y(북쪽) |
|--------|------------|------------|---------|---------|
| 0도 (북) | 0.0 | 1.0 | 0 | 전체 |
| 90도 (동) | 1.0 | 0.0 | 전체 | 0 |
| 180도 (남) | 0.0 | -1.0 | 0 | -전체 |
| 270도 (서) | -1.0 | 0.0 | -전체 | 0 |

- 선회각 0도(북쪽): X=0, Y=양수 → **정북 방향** ✓
- 선회각 90도(동쪽): X=양수, Y=0 → **정동 방향** ✓

**코드에서 사용되는 곳** (`core/geometry.py:107-108`):
```python
tip_x = base_x + horizontal_reach * math.sin(slew_rad)
tip_y = base_y + horizontal_reach * math.cos(slew_rad)
```

---

## 완전한 계산 예시

**조건**:
- 기초 위치: (0, 0)
- 마스트 높이: 40m
- 붐대 길이: 60m
- 선회각: 90도 (동쪽)
- 기복각: 30도

**1단계: 수평 거리 계산**
```
수평 거리 = 60m × cos(30도) = 60 × 0.866 = 51.96m
```

**2단계: X 좌표 (동서 방향)**
```
X = 0 + 51.96 × sin(90도) = 0 + 51.96 × 1.0 = 51.96m
```

**3단계: Y 좌표 (남북 방향)**
```
Y = 0 + 51.96 × cos(90도) = 0 + 51.96 × 0.0 = 0.0m
```

**4단계: Z 좌표 (높이)**
```
Z = 40 + 60 × sin(30도) = 40 + 60 × 0.5 = 70.0m
```

**결과: 붐대 끝점 = (51.96, 0.0, 70.0)**

해석: "기초에서 동쪽으로 약 52m, 높이 70m 지점에 붐대 끝이 있다"

이것이 `core/geometry.py`의 `calculate_boom_tip_position()` 함수가 하는 일입니다!

---

## 자주 하는 질문

### Q: 삼각함수 값을 외워야 하나요?

**아닙니다.** 컴퓨터가 `math.sin()`, `math.cos()`로 자동 계산합니다. 어떤 원리로 돌아가는지만 이해하면 됩니다.

### Q: 라디안이 뭔가요? 왜 변환하나요?

라디안은 각도의 다른 표현 방식입니다. 사람은 "도(degree)"를 쓰지만 컴퓨터의 `math.sin()`, `math.cos()` 함수는 라디안을 받습니다. 코드에서 `math.radians()`로 자동 변환하므로 신경 쓸 필요 없습니다.

### Q: cos은 언제 쓰고 sin은 언제 쓰나요?

- **가로(수평) 구할 때** → cos
- **세로(수직) 구할 때** → sin
- **기억법**: **c**os = **가**로 (ㄱ으로 시작... 은 아니지만, cos가 가로!)
